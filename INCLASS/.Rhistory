knitr::opts_chunk$set(echo = TRUE)
loan.df <- read.csv("LoanApproval.csv")
head(loan.df)
# Check for missing values
sum(is.na(loan.df))
summary(loan.df)
set.seed(2)
# Split the data 80:20
train.sample <- sample(c(1:dim(loan.df)[1]), dim(loan.df)[1]*0.8)
train.df <- loan.df[train.sample,]
test.df <- loan.df[-train.sample,]
logit.reg <- glm(Approval ~ ., train.df, family="binomial")
options(scipen = 999)
summary(logit.reg)
logit.reg.pred <- predict(logit.reg, test.df[,-7], type="response")
# Compare first 20 actual vs predicted values
data.frame(actual = test.df$Approval[1:20], predicted = logit.reg.pred[1:20])
library(gains)
gain <- gains(test.df$Approval, logit.reg.pred, groups=length(logit.reg.pred))
# plot Lift chart
plot(c(0, gain$cume.pct.of.total*sum(test.df$Approval))~c(0,gain$cume.obs), xlab="# records", ylab = "Cumulative Gain", main="Gain and Lift Chart", type="l", col="blue")
lines(c(0, sum(test.df$Approval))~c(0, dim(test.df)[1]), col="red",
legend("topleft",c("With prediction","No Prediction"),fill=c("blue","red")))
library(car)
vif(logit.reg)
theFormula = Approval ~ Term + Income + FICO
logit.reg <- glm(formula = theFormula, train.df, family="binomial")
options(scipen = 999)
summary(logit.reg)
logit.reg.pred <- predict(logit.reg, test.df[,-7], type="response")
# Compare first 20 actual vs predicted values
data.frame(actual = test.df$Approval[1:20], predicted = logit.reg.pred[1:20])
library(gains)
gain <- gains(test.df$Approval, logit.reg.pred, groups=length(logit.reg.pred))
# plot Lift chart
plot(c(0, gain$cume.pct.of.total*sum(test.df$Approval))~c(0,gain$cume.obs), xlab="# records", ylab = "Cumulative Gain", main="Gain and Lift Chart", type="l", col="blue")
lines(c(0, sum(test.df$Approval))~c(0, dim(test.df)[1]), col="red",
legend("topleft",c("With prediction","No Prediction"),fill=c("blue","red")))
library(car)
vif(logit.reg)
logit.reg.prob <- predict(logit.reg, test.df, type="response" )
logit.reg.prob.df <- data.frame(logit.reg.prob)
# Extract only decisions made with a probability higher than 80%
approvals <- ifelse(logit.reg.prob.df > 0.8, 1, 0)
head(approvals, 20)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
library(ROCR)
prob <- predict(logit.reg, newdata = test.df, type="response")
pred <- prediction(prob, test.df$Approval)
# Plot True Positive Rate (tpr) vs False Positive Rate (fpr)
pmf <- performance(pred, measure="tpr", xmeasure="fpr")
plot(pmf, col="red")
auc <- performance(pred, measure="auc")
auc <- auc@y.values[[1]]
auc
install.packages("caret")
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval, predict(logit.reg, test.df)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval, predict(logit.reg, test.df,type="response" )
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval, predict(logit.reg, test.df,type="response"))
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confustionMatrix(test.df$Approval)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval, logit.reg.prob.df)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval,logit.reg.prob.df)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval, logit.reg.prob.df)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_martix <- confusionMatrix(test.df$Approval, approvals)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
confusionMatrix(test.df$Approval, approvals)
knitr::opts_chunk$set(echo = TRUE)
loan.df <- read.csv("LoanApproval.csv")
head(loan.df)
# Check for missing values
sum(is.na(loan.df))
summary(loan.df)
set.seed(2)
# Split the data 80:20
train.sample <- sample(c(1:dim(loan.df)[1]), dim(loan.df)[1]*0.8)
train.df <- loan.df[train.sample,]
test.df <- loan.df[-train.sample,]
logit.reg <- glm(Approval ~ ., train.df, family="binomial")
options(scipen = 999)
summary(logit.reg)
logit.reg.pred <- predict(logit.reg, test.df[,-7], type="response")
# Compare first 20 actual vs predicted values
data.frame(actual = test.df$Approval[1:20], predicted = logit.reg.pred[1:20])
library(gains)
gain <- gains(test.df$Approval, logit.reg.pred, groups=length(logit.reg.pred))
# plot Lift chart
plot(c(0, gain$cume.pct.of.total*sum(test.df$Approval))~c(0,gain$cume.obs), xlab="# records", ylab = "Cumulative Gain", main="Gain and Lift Chart", type="l", col="blue")
lines(c(0, sum(test.df$Approval))~c(0, dim(test.df)[1]), col="red",
legend("topleft",c("With prediction","No Prediction"),fill=c("blue","red")))
library(car)
vif(logit.reg)
theFormula = Approval ~ Term + Income + FICO
logit.reg <- glm(formula = theFormula, train.df, family="binomial")
options(scipen = 999)
summary(logit.reg)
logit.reg.pred <- predict(logit.reg, test.df[,-7], type="response")
# Compare first 20 actual vs predicted values
data.frame(actual = test.df$Approval[1:20], predicted = logit.reg.pred[1:20])
library(gains)
gain <- gains(test.df$Approval, logit.reg.pred, groups=length(logit.reg.pred))
# plot Lift chart
plot(c(0, gain$cume.pct.of.total*sum(test.df$Approval))~c(0,gain$cume.obs), xlab="# records", ylab = "Cumulative Gain", main="Gain and Lift Chart", type="l", col="blue")
lines(c(0, sum(test.df$Approval))~c(0, dim(test.df)[1]), col="red",
legend("topleft",c("With prediction","No Prediction"),fill=c("blue","red")))
library(car)
vif(logit.reg)
logit.reg.prob <- predict(logit.reg, test.df, type="response" )
logit.reg.prob.df <- data.frame(logit.reg.prob)
# Extract only decisions made with a probability higher than 80%
approvals <- ifelse(logit.reg.prob.df > 0.8, 1, 0)
head(approvals, 20)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
confusionMatrix(test.df$Approval, approvals)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
conf_matrix_df <- as.data.frame.table(conf_matrix)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
conf_matrix_df <- as.data.frame.table(conf_matrix)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
conf_matrix_df <- melt(conf_matrix)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
conf_matrix_df <- as.data.frame.table(conf_matrix)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
library(gridExtra)
install.packages("gridExtra")
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
library(gridExtra)
grid.arrange(tableGrob(conf_matrix))
conf_matrix_df <- as.data.frame.table(conf_matrix)
table(test.df$Approval, approvals)
classification.error <- mean(approvals != test.df$Approval)
classification.error
accuracy <- 1 - classification.error
accuracy
## Presition and reacll
## Impot Library
library(caret)
test.df$Approval <- factor(test.df$Approval)
approvals <- factor(approvals)
#create a confution matrix
conf_matrix <- confusionMatrix(test.df$Approval, approvals)
library(gridExtra)
grid.arrange(tableGrob(conf_matrix))
# Rename the columns
colnames(conf_matrix_df) <- c("predicted_no", "predicted_yes")
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
# install and load the e1071 package
install.packages("e1071")
library(e1071)
# install and load the e1071 package
install.packages("e1071")
library(e1071)
install.packages("e1071")
knitr::opts_chunk$set(echo = TRUE)
# install and load the e1071 package
install.packages("e1071")
library(e1071)
install.packages("e1071")
knitr::opts_chunk$set(echo = TRUE)
# install and load the e1071 package
install.packages("e1071")
library(e1071)
install.packages("e1071")
install.packages("e1071")
knitr::opts_chunk$set(echo = TRUE)
# install and load the e1071 package
install.packages("e1071")
library(e1071)
# create a sample dataset
data(iris)
# split the data into a training set and a test set
train_indices <- sample(1:nrow(iris), 0.8*nrow(iris))
train_data <- iris[train_indices,]
test_data <- iris[-train_indices,]
# train the model on the training data
model <- naiveBayes(Species ~ ., data = train_data)
# make predictions on the test data
predictions <- predict(model, test_data)
print(predictions)
# evaluate the accuracy of the model
mean(predictions == test_data$Species)
install.packages("e1071")
knitr::opts_chunk$set(echo = TRUE)
# install and load the e1071 package
install.packages("e1071")
# install and load the e1071 package
install.packages("e1071")
library(e1071)
# create a sample dataset
data(iris)
# split the data into a training set and a test set
train_indices <- sample(1:nrow(iris), 0.8*nrow(iris))
train_data <- iris[train_indices,]
test_data <- iris[-train_indices,]
# train the model on the training data
model <- naiveBayes(Species ~ ., data = train_data)
# make predictions on the test data
predictions <- predict(model, test_data)
print(predictions)
# evaluate the accuracy of the model
mean(predictions == test_data$Species)
knitr::opts_chunk$set(echo = TRUE)
head(data)
describe(data)
head(data)
describe(data)
knitr::opts_chunk$set(echo = TRUE)
#Loading required packages
install.packages('tidyverse')
library(tidyverse)
install.packages('ggplot2')
library(ggplot2)
install.packages('caret')
library(caret)
install.packages('caretEnsemble')
library(caretEnsemble)
install.packages('psych')
library(psych)
install.packages('Amelia')
knitr::opts_chunk$set(echo = TRUE)
#Loading required packages
install.packages('tidyverse')
library(tidyverse)
install.packages('ggplot2')
library(ggplot2)
install.packages('caret')
library(caret)
install.packages('caretEnsemble')
install.packages("ggplot2")
library(caretEnsemble)
install.packages('psych')
library(psych)
install.packages('Amelia')
library(Amelia)
install.packages('mice')
library(mice)
install.packages('GGally')
library(GGally)
install.packages('rpart')
library(rpart)
install.packages('randomForest')
library(randomForest)
install.packages("rpart")
knitr::opts_chunk$set(echo = TRUE)
#Loading required packages
library(tidyverse)
library(ggplot2)
library(caret)
library(caretEnsemble)
library(psych)
library(Amelia)
library(mice)
library(GGally)
library(rpart)
library(randomForest)
#Reading data into R
data<- read.csv("diabetic_data.csv")
#Studying the structure of the data
str(data)
head(data)
describe(data)
#Convert '0' values into NA
data[, 2:7][data[, 2:7] == 0] <- NA
#visualize the missing data
missmap(data)
#Use mice package to predict missing values
mice_mod <- mice(data[, c("Glucose","BloodPressure","SkinThickness","Insulin","BMI")], method='rf')
#Reading data into R
data<- read.csv("diabetic_data.csv")
#Setting outcome variables as categorical
data$Outcome <- factor(data$Outcome, levels = c(0,1), labels = c("False", "True"))
View(gain)
#Reading data into R
data<- read.csv("adult.data")
#Reading data into R
data<- read.csv("adult.data")
#Setting outcome variables as categorical
data$Outcome <- factor(data$Outcome, levels = c(0,1), labels = c("False", "True"))
library(readxl)
adult <- read_excel("adult.csv")
adult <- read.csv("~/INCLASS/adult.csv", header=FALSE)
View(adult)
#Studying the structure of the data
str(data)
#Reading data into R
data<- read.csv("adult.data")
#Reading data into R
data<- read.csv("adult.data")
#Reading data into R
data<- read.csv("adult.data")
#Reading data into R
data<- read.csv("adult.csv")
#Setting outcome variables as categorical
data$Outcome <- factor(data$Outcome, levels = c(0,1), labels = c("False", "True"))
#Reading data into R
data<- read.csv("adult.csv")
#Setting outcome variables as categorical
data$sex <- factor(data$sex, levels = c(0,1), labels = c("False", "True"))
head(data)
describe(data)
#Convert '0' values into NA
data[, 2:7][data[, 2:7] == 0] <- NA
#visualize the missing data
missmap(data)
#Reading data into R
data<- read.csv("adult.csv")
#Studying the structure of the data
str(data)
head(data)
describe(data)
#Convert '0' values into NA
data[, 2:7][data[, 2:7] == 0] <- NA
#visualize the missing data
missmap(data)
#Data Visualization
#Visual 1
ggplot(data, aes(capital.gain, colour = Age)) +
geom_freqpoly(binwidth = 1) + labs(title="Age and capital.gain")
#Data Visualization
#Visual 1
ggplot(data, aes(Age, colour = capital.gain)) +
geom_freqpoly(binwidth = 1) + labs(title="Age and capital.gain")
